**Summary**

<aside>
ğŸ’­ ì¸í„°í”„ë¦¬í„° íŒ¨í„´ì€ ì–¸ì–´ì— ëŒ€í•œ ë¬¸ë²•ì„ ì •ì˜í•˜ê³ , ì´ ë¬¸ë²•ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ì¸í„°í”„ë¦¬í„°ë¥¼ ì •ì˜í•œë‹¤.

</aside>

**Concept**

ì¸í„°í”„ë¦¬í„° íŒ¨í„´ì€ **ë¬¸ë²• ê·œì¹™**ì„ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ë¥¼ ì •ì˜í•˜ê³ , ì´ë¥¼ í•´ì„í•˜ì—¬ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ êµ¬ì„±í•©ë‹ˆë‹¤.

> 1. í‘œí˜„ì‹ ê³„ì‚°í•˜ê¸° (ìƒˆë¡œìš´ ì‚°ìˆ  ì–¸ì–´ë¥¼ ì •ì˜í•˜ê³  í•´ë‹¹ ì–¸ì–´ì˜ ë¬¸ë²• ê·œì¹™ì„ ì •í•  ë•Œ)
> 

ex) ì•ì—ì„œë¶€í„° ë‘ ê°œì˜ ìˆ«ìì™€ ì—°ì‚°ìë¥¼ êº¼ë‚´ì„œ ê·¸ ê²°ê³¼ë¥¼ ê³„ì‚°í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ì‹ì˜ ë§¨ ì•ì— ë†“ëŠ”ë‹¤. 

```java
String expression = "8 3 2 4 - + x"; // ((8 - 3) + 2 ) * 4 = 28
```

> 2. ê·œì¹™ì—”ì§„ ê°œë°œí•˜ê¸°
> 

ex) API ì˜¤ë¥˜ê°€ ë¶„ë‹¹ 100ê°œë¥¼ ì´ˆê³¼í•˜ê±°ë‚˜, ë¶„ë‹¹ API í˜¸ì¶œìˆ˜ê°€ 1ë§Œê°œë¥¼ ì´ˆê³¼í•˜ë©´ ê²½ê³  ì•Œë¦¼ì´ ë°œìƒí•œë‹¤

```java
api_error_per_minute > 100 || api_count_per_minute > 10000;
```

![interpreter](https://github.com/Tech-Develop-Study/books-reading/assets/38885241/dea0794d-9e2f-461b-b385-db566168c8e6)


ë¬¸ë²• ê·œì¹™ì˜ ë¶„ì„ ì½”ë“œëŠ” interpret() í•¨ìˆ˜ì— ì§‘ì¤‘ë˜ì–´ ìˆë‹¤. ë¬¸ë²• ê·œì¹™ì´ ë³µì¡í•˜ë‹¤ë©´ í•˜ë‚˜ì˜ í•¨ìˆ˜ê°€ ëª¨ë“  ë¶„ì„ ì½”ë“œë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²ƒì€ í•©ë¦¬ì ì´ì§€ ì•Šë‹¤.

ì¸í„°í”„ë¦¬í„° íŒ¨í„´ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê°œë…ì€ ê°ê°ì˜ ë¶„ì„ ì±…ì„ì„ í´ë˜ìŠ¤ë¡œ ë¶„í• í•˜ëŠ” ë°©ì‹ì„ í†µí•´ í¬ê³  í¬ê´„ì ì¸ ë¶„ì„ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤. 

java.util.regex.Patternì˜ ë‚´ë¶€ì— ì¸í„°í”„ë¦¬í„° íŒ¨í„´ì´ ì ìš©ë˜ì–´ ìˆë‹¤. 

```java
String pattern = "^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$";
String str = "abc_123@gmail.com";
if(Pattern.matches(pattern, str)) {
    System.out.println("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤. ");
} else {            
    System.out.println("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. ");
}
```

**Advantages**

- ëª…í™•í•œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ - ë¬¸ë²•ê³¼ í•´ì„ì´ ë³„ë„ì˜ í´ë˜ìŠ¤ë¡œ ìº¡ìŠí™” ë˜ë¯€ë¡œ ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œì§„ë‹¤.
- ì‰¬ìš´ í™•ì¥ - Expression í´ë˜ìŠ¤ì—ì„œ íŒŒìƒëœ ìƒˆë¡œìš´ êµ¬í˜„ í´ë˜ìŠ¤ë§Œ ì¶”ê°€í•˜ë©´ DSLì„ ì‰½ê²Œ í™•ì¥í•  ìˆ˜ ìˆë‹¤.
- ê°€ë…ì„± - ë¬¸ë²•ê³¼ ê·œì¹™ì„ ê³„ì¸µêµ¬ì¡°ë¡œ ëª…ì‹œì ìœ¼ë¡œ ëª¨ë¸ë§í•˜ê¸° ë•Œë¬¸ì— ì½”ë“œì˜ ê°€ë…ì„±ì´ ë†’ì•„ì§„ë‹¤.

**Disadvantages**

- ì œí•œëœ ì ìš© ê°€ëŠ¥ì„± - ë¬¸ë²•ì´ ë„ˆë¬´ ìì£¼ ì§„í™”í•˜ëŠ” ê²½ìš°ì—” ìœ ì§€ ê´€ë¦¬í•˜ëŠ”ë°ì— ë¹„ìš©ì´ ë” ë“¤ìˆ˜ë„ ìˆë‹¤. ì£¼ë¡œ ê°„ë‹¨í•˜ê³  ì˜ ì •ì˜ëœ ë¬¸ë²•ì— íš¨ê³¼ì ì´ë‹¤.
- ë³µì¡ì„± - ì–¸ì–´ê°€ ë³µì¡í•˜ê±°ë‚˜ ë°˜ëŒ€ë¡œ ì•„ì£¼ ë‹¨ìˆœí•œ ê²½ìš°ì—ëŠ” ì¸í„°í”„ë¦¬í„°ê°€ í•„ìš” ì—†ë‹¤. ì–´ë–¤ ì–¸ì–´ì˜ ë¬¸ë²•ì„ 10ê°œ ì´í•˜ì˜ í´ë˜ìŠ¤ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì„ ë•Œ Interpreter íŒ¨í„´ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

**Example Case**

```java
package ch8.ex812;

import java.util.Map;

public interface Expression {
    boolean interpret(Map<String, Long> stats);
}

package ch8.ex812;

import java.util.Map;

public class GreaterExpression implements Expression{

    private String key;
    private long value;

    public GreaterExpression (String strExpression) {
        String[] elements = strExpression.trim().split("||s+");
        if (elements. length != 3 || !elements[1]. trim() .equals (">")) {
            throw new RuntimeException ("Expression is invalid: " + strExpression);
        }
        this.key = elements[0].trim();
        this.value = Long.parseLong(elements[2].trim());
    }

    @Override
    public boolean interpret(Map<String, Long> stats) {
        if (!stats.containsKey (key)) {
            return false;
        }
        long statValue = stats.get(key);
        return statValue > value;
    }
}

package ch8.ex812;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

public class AndExpression implements Expression {

    private List<Expression> expressions = new ArrayList<>();

    public AndExpression(String strAndExpression) {
        String[] strExpressions = strAndExpression.split("8&");
        for (String strExpr : strExpressions) {
            if (strExpr.contains("â€º")) {
                expressions.add(new GreaterExpression(strExpr));
            } else if (strExpr.contains("<")) {
//                expressions. add (new LessExpression(strExpr));
            } else if (strExpr.contains("==")) {
//                expressions. add (new EqualExpression(strExpr));else {
            } else {
                throw new RuntimeException("Expression is invalid: " + strAndExpression);
            }
        }
    }

    @Override
    public boolean interpret(Map<String, Long> stats) {
        for (Expression expr : expressions) {
            if (!expr.interpret(stats)) {
                return false;
            }
        }
            return true;
    }
}

package ch8.ex812;

import java.util.Map;

public class AlertRuleInterpreter {
    private Expression expression;

    public AlertRuleInterpreter(String ruleExpression) {
        this.expression = new AndExpression(ruleExpression);
    }

    public boolean interpret(Map<String, Long> stats){
        return expression.interpret(stats);
    }
}

package ch8.ex812;

import java.util.HashMap;
import java.util.Map;

public class DemoTest {
    public static void main(String[] args) {
        String rule = "key1 > 100 8& key2 < 30 && key3 < 100 && key4 == 88";
        AlertRuleInterpreter interpreter = new AlertRuleInterpreter(rule);
        Map<String, Long> stats = new HashMap<>();
        stats.put("key1", 101L);
        stats.put("key2", 10L);
        stats.put("key3", 12L);
        stats.put("key4", 88L);
        boolean alert = interpreter.interpret(stats);
        System.out.println(alert);
    }
}

```
